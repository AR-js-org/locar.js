import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */import{P as p,W as w,S as l,B as g,M as u,a as f}from"./three.module-D1bjPEXB.js";import{H as h,q as b,j as v}from"./locar.es-owlD19To.js";const n=new p(80,window.innerWidth/window.innerHeight,.001,1e3),i=new w({canvas:document.getElementById("glscene")});i.setSize(window.innerWidth,window.innerHeight);const s=new l,o=new h(s,n),r=new b(n);r.on("deviceorientationgranted",e=>{e.target.connect()});r.on("deviceorientationerror",e=>{alert(`Device orientation error: code ${e.code} message ${e.message}`)});r.init();const m=new v({video:{facingMode:"environment"}},null);m.on("webcamstarted",e=>{s.background=e.texture});m.on("webcamerror",e=>{alert(`Webcam error: code ${e.code} message ${e.message}`)});window.addEventListener("resize",e=>{i.setSize(window.innerWidth,window.innerHeight),n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix()});let d=!0;const c={},y=new g(20,20,20);o.on("gpserror",e=>{alert(`GPS error: code ${e.code}`)});o.on("gpsupdate",async e=>{(d||e.distMoved>100)&&((await(await fetch(`https://hikar.org/webapp/map?bbox=${e.position.coords.longitude-.02},${e.position.coords.latitude-.02},${e.position.coords.longitude+.02},${e.position.coords.latitude+.02}&layers=poi&outProj=4326`)).json()).features.forEach(t=>{if(!c[t.properties.osm_id]){const a=new u(y,new f({color:16711680}));o.add(a,t.geometry.coordinates[0],t.geometry.coordinates[1],0,t.properties),c[t.properties.osm_id]=a}}),d=!1)});document.getElementById("setFakeLoc").addEventListener("click",e=>{alert("Using fake input GPS, not real GPS location"),o.stopGps(),o.fakeGps(parseFloat(document.getElementById("fakeLon").value),parseFloat(document.getElementById("fakeLat").value))});o.startGps();i.setAnimationLoop($);function $(){r.update(),i.render(s,n)}
